<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">
<ui:composition template="/template/escolar/template-alumno.xhtml">
    <ui:define name="menu">
        <div class="left-content-box  content-box-dark">
            <h:graphicImage library="img" name="avatar/astronauta-nino.svg" alt="" class="uk-border-circle profile-img" rendered="#{true}"/>
            <h:graphicImage library="img" name="avatar/astronauta-nina.svg" alt="" class="uk-border-circle profile-img" rendered="#{false}"/>
            <h6 class="uk-text-center uk-margin-remove-vertical text-light nombre-usuario">#{alumnoControlador.alumnoModelo.apodo}</h6>
            <div class="uk-position-relative uk-text-center uk-display-block">
                <!--Modificar los datos para mostrar en el Alumno-->
                <a href="#" class="uk-text-small uk-text-muted uk-display-block uk-text-center uk-text-capitalize" data-uk-icon="icon: triangle-down; ratio: 0.7">#{etiqueta['menu']}</a>
                <!-- user dropdown -->
                <div class="uk-dropdown user-drop" data-uk-dropdown="mode: click; pos: bottom-center; animation: uk-animation-slide-bottom-small; duration: 150">
                    <ul >
                        <li><a href="#" class="uk-text-capitalize">#{alumno['profile']}</a></li>
                        <li><a href="#" class="uk-text-capitalize">#{etiqueta['close.sesion']}</a></li>
                    </ul>
                </div>
                <!-- /user dropdown -->
            </div>
        </div>
        <div class="left-nav-wrap  uk-visible@xl ">
            <ul class="uk-thumbnav uk-thumbnav-vertical uk-position-center uk-margin-large-top">
                <li uk-tooltip="title: Dashboard; pos: right"><h:link outcome="dashboard"><h:graphicImage library="img" name="alumno/planetas/tierra.svg" width="80" alt=""/></h:link></li>
                <li uk-tooltip="title: Activity; pos: right" class="uk-active"><h:link outcome="actividades"><h:graphicImage library="img" name="alumno/planetas/planeta1.svg" width="80" alt="" /></h:link></li>
                <li uk-tooltip="title: Glossary; pos: right"><h:link outcome="glosario"><h:graphicImage library="img" name="alumno/planetas/planeta2.svg"  width="80" alt="" /></h:link></li>
                <li uk-tooltip="title: Grammar; pos: right"><h:graphicImage library="img" name="alumno/planetas/planeta3.svg"  width="80" alt="" /></li>
                <li uk-tooltip="title: Map Mental; pos: right"><h:link outcome="mapa-mental"><h:graphicImage library="img" name="alumno/planetas/planeta4.svg"  width="80" height="" alt="" /></h:link></li>
                <li uk-tooltip="title: Library; pos: right"><h:link outcome="biblioteca-alumno"><h:graphicImage library="img" name="alumno/planetas/planeta5.svg"  width="80" alt="" /></h:link></li>
            </ul>
        </div>
        <div class="left-nav-wrap uk-position-relative  uk-hidden@xl ">
            <ul class="uk-thumbnav uk-thumbnav-vertical uk-position-top-center uk-margin-small-top">
                <li uk-tooltip="title: Dashboard; pos: right"><h:link outcome="dashboard"><h:graphicImage library="img" name="alumno/planetas/tierra.svg"  width="50" alt=""/></h:link></li>
                <li uk-tooltip="title: Activity; pos: right" class="uk-active"><h:link outcome="actividades"><h:graphicImage library="img" name="alumno/planetas/planeta1.svg"  width="50" alt=""/></h:link></li>
                <li uk-tooltip="title: Glossary; pos: right"><h:link outcome="glosario"><h:graphicImage library="img" name="alumno/planetas/planeta2.svg"  width="50" alt=""/></h:link></li>
                <li uk-tooltip="title: Grammar; pos: right"><h:graphicImage library="img" name="alumno/planetas/planeta3.svg"  width="50" alt=""/></li>
                <li uk-tooltip="title: Map Mental; pos: right"><h:link outcome="mapa-mental"><h:graphicImage library="img" name="alumno/planetas/planeta4.svg"  width="50" alt=""/></h:link></li>
                <li uk-tooltip="title: Library; pos: right"><h:link outcome="biblioteca-alumno"><h:graphicImage library="img" name="alumno/planetas/planeta5.svg"  width="50" alt=""/></h:link></li>
            </ul>
        </div>
    </ui:define>
    <ui:define name="contenido">
        <h:outputStylesheet library="css" name="alumno/transcript/transcript.css"/>
        <h:outputStylesheet library="css" name="/alumno/transcript/variables-alumno.css"/>
        <h:outputStylesheet library="css" name="/alumno/transcript/lista-ordenar.css"/>
        <h:outputStylesheet library="css" name="/alumno/transcript/ordenar-palabra.css"/>
        <h:outputStylesheet library="css" name="/alumno/transcript/transcript-drag.css"/>
        <h:outputStylesheet library="css" name="letra.css"/>
        <div class="uk-section margen-superior"  style="box-sizing: border-box">
            <div class="uk-container padding-contenedor">
                <h:panelGroup layout="block" styleClass="" pt:uk-filter="target: .js-filter">
                    <ul class="uk-subnav uk-subnav-pill uk-flex uk-flex-center "  >
                        <li uk-filter-control=".transcrip" uk-tooltip="Video" class="uk-active uk-animation-toggle" tabindex="0"><h:graphicImage library="img" name="mounstro/morado.svg" width="70" height="70"  alt="" styleClass="uk-border-circle uk-animation-shake"/></li>
                        <li uk-filter-control=".match" uk-tooltip="Match" class="uk-animation-toggle" tabindex="0"><h:graphicImage library="img" name="mounstro/naranja.svg" width="70" height="70" styleClass="uk-border-circle uk-animation-shake"/></li>
                        <li uk-filter-control=".order-words" uk-tooltip="Order Words" class="uk-animation-toggle" tabindex="0"><h:graphicImage library="img" name="mounstro/3ojos.svg" width="70" height="70" styleClass="uk-border-circle uk-animation-shake"/></li>
                        <li uk-filter-control=".answer" uk-tooltip="Transcript" class="uk-animation-toggle" tabindex="0"><h:graphicImage library="img" name="mounstro/verde.svg" width="70" height="70" styleClass="uk-border-circle uk-animation-shake"/></li>
                    </ul>

                    <ul class="js-filter  uk-text-center" >
                        <li class="transcrip">
                           <h:panelGroup styleClass="uk-grid" pt:uk-grid="">
                               <div class="uk-width-1-2@m tam-contenido uk-padding-remove-left ">
                                   <iframe class="" width="100%" height="100%" src="https://www.youtube.com/embed/#{alumnoControlador.tareaActividadModelo.idActividad}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
                               </div>
                               <div class="uk-width-1-2@m uk-text-justify transcrip-contenedor tam-contenido scroll-alumno letra-guion borde-guion transcripcion">
                                   <h:outputText value="#{actividadAlumnoControlador.transcripcion}" escape="false"/>
                               </div>
                           </h:panelGroup>
                        </li>
                        <li class="match uk-margin-small-top " value="#{relacionarOracionControlador.tareaRelacionarOracionModeloLista.get(0).respuesta != null ? true : false}">
                            <h:form id="formulario-relacionar">
                                <h1 class="uk-text-center lescuadron" style="color: white">Relacionar respuesta</h1>
                                <h:panelGroup layout="block" styleClass="uk-grid padre contenedor-matching" pt:uk-grid="">
                                    <div class="columna-pregunta uk-width-expand">
                                        <table id="tabla" class="tabla-ordenar uk-table-middle">
                                            <thead class="titulo-tabla uk-text-center">
                                            <tr>
                                                <th>Question</th>
                                                <th>Answer</th>
                                            </tr>
                                            </thead>
                                            <tbody class="cuerpo-tabla uk-text-center">
                                                <ui:repeat value="#{relacionarOracionControlador.tareaRelacionarOracionModeloLista}" var="relacionarOracion">
                                                    <tr>
                                                        <td>#{relacionarOracion.relacionarOracionModelo.pregunta}</td>
                                                        <td class="uk-sortable" uk-sortable="group: respuesta">#{relacionarOracion.respuesta != null ? relacionarOracionControlador.respuestaVal(relacionarOracion.respuesta) : ""}</td>
                                                    </tr>
                                                </ui:repeat>
                                            </tbody>
                                        </table>
                                    </div>
                                    <h:panelGroup id="tablaRespuestas" style="" layout="block"  styleClass="uk-width-auto respuestas-ordenar uk-sortable" pt:uk-sortable="group: respuesta"  >
                                        <ui:repeat value="#{relacionarOracionControlador.desordenaLista(relacionarOracionControlador.tareaRelacionarOracionModeloLista)}" var="preRespuestas">
                                            <div class="respuesta" data-id="#{preRespuestas.relacionarOracionModelo.id}">#{relacionarOracion.respuesta != null ? preRespuestas.relacionarOracionModelo.respuesta : preRespuestas.relacionarOracionModelo.respuesta}</div>
                                        </ui:repeat>
                                    </h:panelGroup>
                                </h:panelGroup>
                                <h:inputHidden id="respuestaOraciones" value="#{relacionarOracionControlador.idRespuesta}"/>
                                <h:commandButton id="buttonEnviar" style="" onclick="recuperaDatos()" styleClass="uk-button uk-button-primary uk-margin"  value="Submit Answer">
                                    <f:ajax listener="#{relacionarOracionControlador.llenarTareaModelo()}" execute="@form"/>
                                </h:commandButton>
                            </h:form>
                        </li>
                        <li class="order-words">
                            <h1 class="uk-text-center lescuadron" style="color: white">Ordenas las palabras en el orden correspondiente</h1>
                            <div class="imagen-ordenar">
                                <h:graphicImage library="img" name="mounstro/whom.svg"/>
                            </div>
                            <ul class="uk-subnav uk-subnav-pill uk-flex uk-flex-center" uk-switcher="">
                                <ui:repeat value="#{gramaticaControlador.gramaticaModeloLista}" var="gramatica" varStatus="estatus">
                                    <li><a href="#">#{estatus.index + 1}</a></li>
                                </ui:repeat>
                            </ul>
                            <ul class="uk-switcher uk-margin">
                                <ui:repeat value="#{gramaticaControlador.gramaticaModeloLista}" var="gramatica">
                                    <li>
                                        <h:outputText value="Resuelto" rendered="#{not empty gramatica.respuesta}"/>
                                        <h:form>
                                            <h:panelGroup layout="block" styleClass="uk-container padding-contenedor estilo-contenedor">
                                                <h:inputHidden value="#{empty gramatica.respuesta ? gramatica.palabra : gramatica.respuesta}" pt:data-respuesta="#{empty gramatica.respuesta}"/>
                                                <h:panelGroup layout="block" styleClass="uk-child-width-1-5@m uk-grid  uk-padding-small" pt:uk-grid="" pt:uk-sortable="" rendered="#{empty gramatica.respuesta}"/>
                                                <h:panelGroup layout="block" styleClass="uk-child-width-1-5@m uk-grid  uk-padding-small" pt:uk-grid="" rendered="#{not empty gramatica.respuesta}"/>
                                            </h:panelGroup>
                                            <h:inputHidden value="#{tareaGramaticaControlador.respuesta}"/>
                                            <h:commandButton value="Send" onclick="completarPalabra(this)" rendered="#{empty gramatica.respuesta}">
                                                <f:ajax listener="#{tareaGramaticaControlador.enviarRespuesta(gramatica.codigo, gramatica.actividadModelo.idVideo)}"
                                                        execute="@form" onevent="function funcion(data) { remueveOrdenador(data) }"/>
                                            </h:commandButton>
                                        </h:form>
                                    </li>
                                </ui:repeat>
                            </ul>
                        </li>
                        <li class="answer">
                            <h:panelGroup layout="block" styleClass="uk-child-width-1-2@m uk-grid" pt:uk-grid="">
                                <h:panelGroup layout="block" >
                                    <h:panelGroup layout="block" styleClass="uk-sortable contenedor-respuesta" pt:uk-sortable="group: respuesta">
                                        <h:graphicImage library="img" styleClass="marciano" name="mounstro/verde.svg" />
                                        <div class="respuesta-drag">uno</div>
                                        <div class="respuesta-drag">dos</div>
                                        <div class="respuesta-drag">tres</div>
                                        <div class="respuesta-drag">cuatro</div>
                                        <div class="respuesta-drag">cinco</div>
                                        <div class="respuesta-drag">seis</div>
                                        <div class="respuesta-drag">siete</div>
                                        <div class="respuesta-drag">ocho</div>
                                        <div class="respuesta-drag">nueve</div>
                                    </h:panelGroup>
                                </h:panelGroup>
                                <div class="trancript-contenedor arrastrar scroll-drag uk-text-justify remplazar ">
                                    <h:outputText value="#{actividadAlumnoControlador.transcripcion}" escape="false"/>
                                </div>
                            </h:panelGroup>
                        </li>
                    </ul>
                </h:panelGroup>

            </div>
        </div>
        <script type="text/javascript">
            document.querySelectorAll('.estilo-contenedor input[type=hidden]').forEach(function (palabra) {
                subPalabra = palabra.value.split(" ");
                if (palabra.dataset.respuesta === 'true') {
                    subPalabra = revolver(subPalabra);
                }
                subPalabra.forEach(function (value1) {
                    if (value1.trim() !== '') {
                        padre = document.createElement('div');
                        hijo = document.createElement('div');
                        hijo.classList.add('palabra','uk-text-center');
                        hijo.appendChild(document.createTextNode(value1.toLowerCase().replace('.','')));
                        padre.appendChild(hijo);
                        palabra.nextElementSibling.appendChild(padre);
                    }
                });
            });

            function revolver(arreglo) {
                var indiceActual = arreglo.length, temporal, indiceAleatorio;
                while (0 !== indiceActual) {
                    indiceAleatorio = Math.floor(Math.random() * indiceActual);
                    indiceActual -= 1;
                    temporal = arreglo[indiceActual];
                    arreglo[indiceActual] = arreglo[indiceAleatorio];
                    arreglo[indiceAleatorio] = temporal;
                }
                return arreglo;
            }
            
            function completarPalabra(elemento) {
                var texto = elemento.previousElementSibling.previousElementSibling.querySelectorAll('div > div > .palabra');
                var respuesta = '';
                texto.forEach(function (value) {
                    respuesta = respuesta.concat(value.textContent).concat(' ');
                });
                elemento.previousElementSibling.value = respuesta.trim();
            }

            function remueveOrdenador(data) {
                if (data.status === 'success') {
                    data.source.previousElementSibling.previousElementSibling.querySelector('.uk-sortable').removeAttribute('uk-sortable');
                    data.source.disabled = true;
                }
            }

            function recuperaDatos() {
                var idRelacionarmodelos = document.querySelectorAll('.match tbody .respuesta');
                var getId = [];
                idRelacionarmodelos.forEach(function (input) {
                    getId.push(input.dataset.id);
                });
                document.getElementById('formulario-relacionar:respuestaOraciones').value = getId.join();
                document.querySelector('input[type=submit]').disabled = true;
            }

            document.addEventListener('DOMContentLoaded', estaResuelto);
            function estaResuelto() {
                if (document.querySelector('.match').getAttribute('value') === 'true'){
                    var boton = document.getElementById('formulario-relacionar:buttonEnviar');
                    var tabla = document.getElementById('formulario-relacionar:tablaRespuestas');
                    boton.style.display = 'none';
                    tabla.style.display = 'none';
                }
            }
        </script>
        <script type="text/javascript">
            document.querySelectorAll('.remplazar .remover').forEach(function (value) {
                value.setAttribute("uk-sortable","group: respuesta");
                value.setAttribute('class','uk-sortable respuesta-transcript');
                value.innerHTML=" ";
            });
        </script>

    </ui:define>
</ui:composition>
</html>
