<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:h="http://xmlns.jcp.org/jsf/html"
	  xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	  xmlns:f="http://xmlns.jcp.org/jsf/core"
	  xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:pa="http://java.sun.com/jsf/composite/paginacion">

    <ui:composition template="/template/template.xhtml">
        <ui:define name="contenido2">
           	<h:outputStylesheet library="css" name="tablas.css"/>
			<div class="uk-overflow-auto">
				<h1 class="uk-text-center uk-heading-line"><span>Detalles de la Escuela</span></h1>
				<h:dataTable id="tabla-escuela"
							 styleClass="uk-table"
							 value="#{escuelaDashboardControlador.paginacionModeloDato}"
							 binding="#{escuelaDashboardControlador.htmlDataTable}"
							 var="escuela"
							 first="0"
							 rows="#{escuelaDashboardControlador.filasEnPagina}"
							 footerClass="uk-background-primary"
							 columnClasses=",,uk-text-center,uk-text-center,uk-text-center,uk-text-center">
					<h:column headerClass="uk-background-primary uk-width-small uk-text-middle">
						<f:facet name="header"><h:outputText value="#{mensaje['school.cct']}" styleClass="titulo-blanco"/></f:facet>
						#{escuela.claveCentroTrabajo}
					</h:column>
					<h:column headerClass="uk-background-primary">
						<f:facet name="header">
							<div class="uk-flex uk-flex-between uk-flex-middle">
								<h:outputText value="#{mensaje['school.name']}" styleClass="titulo-blanco"/>
								<h:outputLink value="#modal-busqueda-nombre" styleClass="titulo-blanco uk-navbar-toggle" pt:uk-search-icon="" pt:uk-toggle=""/>
							</div>
						</f:facet>
						#{escuela.nombre}
					</h:column>
					<h:column headerClass="uk-background-primary uk-width-small uk-text-center uk-text-middle">
						<f:facet name="header"><h:outputText value="#{mensaje['school.licenses']}" styleClass="titulo-blanco"/></f:facet>
						#{escuela.licencias}
					</h:column>
					<h:column headerClass="uk-background-primary uk-width-small uk-text-center uk-text-middle">
						<f:facet name="header"><h:outputText value="#{mensaje['school.remaining.days']}" styleClass="titulo-blanco"/></f:facet>
						#{escuela.diasRestantes}
					</h:column>
					<h:column headerClass="uk-background-primary uk-width-small uk-text-center uk-text-middle">
						<f:facet name="header"><h:outputText value="#{mensaje['school.status']}" styleClass="titulo-blanco"/></f:facet>
						<h:outputText pt:uk-icon="check" styleClass="uk-icon-button uk-margin-small-right" rendered="#{escuela.estatus}"/>
						<h:outputText pt:uk-icon="ban" styleClass="uk-icon-button uk-margin-small-right" rendered="#{not escuela.estatus}"/>
					</h:column>
					<h:column headerClass="uk-background-primary uk-width-small uk-text-center uk-text-middle">
						<f:facet name="header"><h:outputText value="#{mensaje['school.option']}" styleClass="titulo-blanco"/></f:facet>
						<h:outputText pt:uk-icon="more-vertical" styleClass="uk-icon-button uk-margin-small-right"/>
					</h:column>
					<f:facet name="footer">
						<pa:pie-tabla htmlDataTable="#{escuelaDashboardControlador.htmlDataTable}"/>
					</f:facet>
				</h:dataTable>
			</div>
			<f:ajax render="tabla-escuela formulario-paginacion-colonia"
					listener="#{escuelaDashboardControlador.cargaDatos(escuelaDashboardControlador.htmlDataTable.first)}"
					onevent="limpiaInput">
				<h:form id="formulario-paginacion-colonia">
					<h:panelGroup styleClass="uk-margin-top" pt:uk-grid="">
						<div class="uk-panel uk-flex uk-flex-left uk-width-1-1@s uk-width-1-2@m">
							<pa:boton accionSiguiente="#{escuelaDashboardControlador.vistaSiguiente}"
									  accionAnterior="#{escuelaDashboardControlador.vistaAnterior}"
									  htmlDataTable="#{escuelaDashboardControlador.htmlDataTable}"
									  maximo="#{escuelaDashboardControlador.maximo}"
									  filasEnPagina="#{escuelaDashboardControlador.filasEnPagina}"/>
						</div>
						<div class="uk-panel uk-flex uk-flex-right@m uk-flex-center@s uk-width-1-1@s uk-width-1-2@m">
							<button class="uk-button uk-button-primary" uk-toggle="target: #modal-escuela">
								<span class="uk-margin-small-right"><h:outputText value="#{mensaje['button.add']}"/></span>
								<h:outputText pt:uk-icon="icon: plus-circle"/>
							</button>
						</div>
					</h:panelGroup>
				</h:form>
			</f:ajax>
			<h:panelGroup id="modal-busqueda-nombre" styleClass="uk-flex-top" pt:uk-modal="">
				<div class="uk-modal-dialog uk-margin-auto-vertical">
					<div class="uk-modal-header uk-background-secondary">
						<p class="uk-h4 uk-text-center uk-text-bold"><span class="letra-titulo">Busca por nombre</span></p>
					</div>
					<h:form id="formulario-busqueda-nombre" class="uk-form-stacked">
						<div class="uk-modal-body">
							<div class="uk-margin">
								<h:outputLabel for="input-busqueda-nombre" styleClass="uk-form-label" value="Palabra Clave"/>
								<div class="uk-form-controls">
									<h:inputText styleClass="uk-input"
												 id="input-busqueda-nombre"
												 pt:placeholder="Escriba texto..."
												 value="#{escuelaDashboardControlador.escuelaBaseDtoModelo.nombre}"
												 label="nombre">
										<f:validateRequired/>
										<f:validateLength minimum="2"/>
									</h:inputText>
								</div>
							</div>
							<ui:fragment rendered="#{facesContext.validationFailed}">
								<h:panelGroup layout="block" styleClass="uk-alert-danger"  pt:uk-alert="">
									<h:message id="mensaje-error-busqueda-nombre" for="input-busqueda-nombre"/>
								</h:panelGroup>
							</ui:fragment>
						</div>
						<div class="uk-modal-footer uk-text-right">
							<button class="uk-button uk-button-default uk-modal-close uk-margin-small-right" type="button">Cancelar</button>
							<h:commandButton styleClass="uk-button uk-button-secondary" value="#{mensaje['button.search']}">
								<f:ajax execute="@form" listener="#{escuelaDashboardControlador.filtrar}" render="tabla-escuela @form"/>
							</h:commandButton>
						</div>
					</h:form>
				</div>
			</h:panelGroup>
			<h:panelGroup layout="block" id="modal-escuela" class="uk-modal-container" pt:uk-modal="">
				<div class="uk-modal-dialog uk-margin-auto-vertical">
					<h:form id="formulario-escuela">
						<div class="uk-modal-header uk-background-secondary">
							<p class="uk-h4 uk-text-center uk-text-bold uk-text-capitalize">
								<h:outputText value="#{mensaje['school.add.title']}" styleClass="letra-titulo" rendered="#{empty escuelaDashboardControlador.escuelaDetalleDtoModelo.claveCentroTrabajo}"/>
								<h:outputText value="#{mensaje['school.add.title']}" styleClass="letra-titulo" rendered="#{not empty escuelaDashboardControlador.escuelaDetalleDtoModelo.claveCentroTrabajo}"/>
							</p>
						</div>
						<div class="uk-modal-body">
							<div uk-grid="">
								<div class="uk-width-1-1@s uk-width-1-6@m">
									<h:outputLabel styleClass="uk-form-label uk-text-uppercase" for="input-escuela-cct" value="#{mensaje['school.cct']}"/>
									<div class="uk-form-controls">
										<h:inputText styleClass="uk-input"
													 id="input-escuela-cct"
													 pt:placeholder="#{mensaje['school.cct']}"
													 label="#{mensaje['school.cct']}"
													 value="#{escuelaDashboardControlador.escuelaDetalleDtoModelo.claveCentroTrabajo}">
											<f:validateRequired/>
											<f:validateLength minimum="9" maximum="10"/>
										</h:inputText>
									</div>
								</div>
								<div class="uk-width-1-1@s uk-width-1-2@m">
									<h:outputLabel styleClass="uk-form-label uk-text-capitalize" for="input-escuela-nombre" value="#{mensaje['school.name']}"/>
									<div class="uk-form-controls">
										<h:inputText styleClass="uk-input"
													 id="input-escuela-nombre"
													 pt:placeholder="#{mensaje['school.name']}"
													 label="#{mensaje['school.name']}"
													 value="#{escuelaDashboardControlador.escuelaDetalleDtoModelo.nombre}">
											<f:validateRequired/>
										</h:inputText>
									</div>
								</div>
								<div class="uk-width-1-1@s uk-width-1-6@m">
									<h:outputLabel styleClass="uk-form-label uk-text-capitalize" for="input-escuela-codigo-postal" value="#{mensaje['school.postalcode']}"/>
									<div class="uk-form-controls">
										<h:inputText styleClass="uk-input"
													 id="input-escuela-codigo-postal"
													 pt:placeholder="#{mensaje['school.postalcode']}"
													 label="#{mensaje['school.postalcode']}"
													 value="#{escuelaDashboardControlador.escuelaDetalleDtoModelo.coloniaDto.codigoPostal}">
											<f:validateRequired/>
										</h:inputText>
									</div>
								</div>
								<div class="uk-inline uk-width-1-1@s uk-width-1-6@m ">
									<h:commandButton styleClass="uk-button uk-button-secondary uk-position-bottom-center"
													 value="#{mensaje['button.search']}">
										<f:ajax execute="input-escuela-codigo-postal"
												render="seleccion-colonia input-escuela-municipio input-escuela-estado"
												listener="#{escuelaDashboardControlador.buscaColonia}" onevent="limpiaInput"/>
									</h:commandButton>
								</div>
								<div class="uk-inline uk-width-1-1@s uk-width-1-2@m">
									<div class="uk-margin">
										<h:outputLabel styleClass="uk-form-label uk-text-capitalize" value="#{mensaje['school.colony']}" for="seleccion-colonia"/>
										<div class="uk-form-controls">
											<h:selectOneMenu styleClass="uk-select"
															 value="#{escuelaDashboardControlador.escuelaDetalleDtoModelo.coloniaDto.id}"
															 id="seleccion-colonia">
												<f:selectItem itemLabel="Selecciones ..." itemValue="0" noSelectionOption="true"/>
												<f:selectItems value="#{escuelaDashboardControlador.coloniaDtoLista}"
																var="colonia"
																itemValue="#{colonia.id}"
																itemLabel="#{colonia.nombre}"/>
												<f:validateRequired/>
											</h:selectOneMenu>
										</div>
									</div>
								</div>
								<div class="uk-width-1-1@s uk-width-1-2@m">
									<h:outputLabel styleClass="uk-form-label uk-text-capitalize" value="#{mensaje['school.street']}" for="input-escuela-calle"/>
									<div class="uk-form-controls">
										<h:inputText styleClass="uk-input"
													 id="input-escuela-calle"
													 pt:placeholder="#{mensaje['school.street']}"
													 label="#{mensaje['school.street']}"
													 value="#{escuelaDashboardControlador.escuelaDetalleDtoModelo.calle}">
											<f:validateRequired/>
										</h:inputText>
									</div>
								</div>
								<div class="uk-width-1-1@s uk-width-1-6@m">
									<h:outputLabel styleClass="uk-form-label uk-text-capitalize" value="#{mensaje['school.street.num.ext']}" for="input-escuela-numero-exterior"/>
									<div class="uk-form-controls">
										<h:inputText styleClass="uk-input"
													 id="input-escuela-numero-exterior"
													 pt:placeholder="#{mensaje['school.street.num.ext']}"
													 value="#{escuelaDashboardControlador.escuelaDetalleDtoModelo.numeroExterior}"
													 label="#{mensaje['school.street.num.ext']}">
											<f:validateRequired/>
											<f:validateLength minimum="1"/>
										</h:inputText>
									</div>
								</div>
								<div class="uk-width-1-1@s uk-width-1-6@m">
									<h:outputLabel styleClass="uk-form-label uk-text-capitalize" value="#{mensaje['school.street.num.int']}" for="input-escuela-numero-interior"/>
									<div class="uk-form-controls">
										<h:inputText styleClass="uk-input"
													 id="input-escuela-numero-interior"
													 value="#{escuelaDashboardControlador.escuelaDetalleDtoModelo.numeroInterior}"
													 pt:placeholder="#{mensaje['school.street.num.int']}"
													 label="#{mensaje['school.street.num.int']}">
											<f:validateLength minimum="1" maximum="15"/>
										</h:inputText>
									</div>
								</div>
								<div class="uk-width-1-1@s uk-width-2-5@m">
									<h:outputLabel styleClass="uk-form-label uk-text-capitalize" value="#{mensaje['school.city']}" for="input-escuela-municipio"/>
									<div class="uk-form-controls">
										<h:inputText styleClass="uk-input"
													 id="input-escuela-municipio"
													 value="#{escuelaDashboardControlador.escuelaDetalleDtoModelo.municipioDto.nombre}"
													 pt:placeholder="#{mensaje['school.city']}"
													 label="#{mensaje['school.city']}"
													 disabled="true"/>
									</div>
								</div>
								<div class="uk-width-1-1@s uk-width-1-4@m">
									<h:outputLabel styleClass="uk-form-label uk-text-capitalize" value="#{mensaje['school.town']}" for="input-escuela-estado"/>
									<div class="uk-form-controls">
										<h:inputText styleClass="uk-input"
													 id="input-escuela-estado"
													 value="#{escuelaDashboardControlador.escuelaDetalleDtoModelo.estadoDto.nombre}"
													 pt:placeholder="#{mensaje['school.town']}"
													 label="#{mensaje['school.town']}"
													 disabled="true"/>
									</div>
								</div>
								<ui:fragment rendered="#{facesContext.validationFailed}">
									<div class="uk-width-1-1@s">
										<div class="uk-alert-danger" uk-alert="">
											<h:messages styleClass="uk-list"/>
										</div>
									</div>
								</ui:fragment>
							</div>
						</div>
						<div class="uk-modal-footer uk-flex uk-flex-right">
							<h:commandButton styleClass="uk-button uk-button-default uk-modal-close uk-margin-small-right"
											 value="#{mensaje['button.cancel']}">
								<f:ajax render="@form" onevent="limpiaInput"/>
							</h:commandButton>
							<h:commandButton styleClass="uk-button uk-button-secondary"
											 value="#{mensaje['button.add']}">
								<f:ajax execute="@form" render="@form" listener="#{escuelaDashboardControlador.agrega}" onevent="limpiaInput"/>
							</h:commandButton>
						</div>
					</h:form>
				</div>
			</h:panelGroup>
			<script type="text/javascript">
				var modalBusquedaNombre = document.querySelector('#modal-busqueda-nombre');
				var modalEscuela = document.querySelector('#modal-escuela');
				document.addEventListener("DOMContentLoaded", function (evt) {
					limpiaInput();
					UIkit.util.on('#modal-busqueda-nombre', 'hidden', function () {
						modalBusquedaNombre.querySelectorAll('.uk-input').forEach(function (entrada) { entrada.value = '' });
					});
					UIkit.util.on('#modal-escuela', 'hidden', function () {
						modalEscuela.querySelectorAll('.uk-input').forEach(function (entrada) { entrada.value = '' });
					});
				});

				function limpiaInput() {
					document.querySelectorAll('.uk-select').forEach(function (value) { value.removeAttribute('size') });
				}
			</script>
        </ui:define>
    </ui:composition>

</html>
